# version 0.0.1
- 책 제목을 입력하면 해당 책의 평점, 리뷰수를 플랫폼 별로 수집
    - 수집할 플랫폼
        - 국내
            - 교보문고
            - yes24
            - 알라딘
            - 왓챠피디아
            - 리디북스
            - 밀리의 서재
        - 해외
            - amazon books
            - goodreads
- 사실 평점은 구글 검색만 해도 상단에 나오기 때문에, 플랫폼 별 크롤링 보안이 강하다면 구글 검색으로 대체하는 것도 고려

### 고민
- 모든 플랫폼을 통틀어 고유한 책을 식별할 수 있는 방법
    - 첫번째 접근: 책제목을 통해 ISBN을 찾고, ISBN을 통해 각 플랫폼에서 책을 찾기
        - 한계: 번역된 책의 경우 ISBN이 다를 수 있음 

# TODO
- 같은 원서에 대한 여러 번역본이 있을 때, 각각의 평점과 리뷰를 수집
- 뉴욕타임스 선정 21세기 최고의 책, 지식인의 서재 등 특정 리스트에 오른 책들 수집
- 리뷰 텍스트들 수집. 전반적인 텍스트 내용 분석.

---

# 문제 분석 로그

## [2026-02-04] 교보문고 검색 결과 불일치 문제

### 현상
```
검색어: "밝은밤 최은영"
- kyobo: [국내도서] 최은영 3종 특별 한정 에디션 (X)
- yes24: 밝은 밤 (O)
- aladin: 밝은 밤 (O)
```

### 원인 분석
1. **검색 결과 우선순위 문제**: 교보문고 검색 결과에서 "3종 특별 한정 에디션"이 상위에 노출
2. **매칭 로직 한계**: 현재 로직은 `query_lower in book_name.lower()`로 체크하는데, "밝은밤"이 "[국내도서] 최은영 3종 특별 한정 에디션"에 포함되지 않음
3. **폴백 동작**: 정확한 매칭이 없으면 첫 번째 유효한 결과를 반환

### 해결 방안 (우선순위)
1. **[P1] 제목 매칭 개선**: 검색어의 각 단어가 제목에 포함되는지 개별 체크
   - "밝은밤" → "밝은 밤" 공백 처리
   - "최은영" → 저자명으로 분리하여 저자 필드에서 매칭
2. **[P2] 세트/에디션 제외**: "[세트]", "에디션", "3종" 등 키워드가 포함된 결과 제외
3. **[P3] 저자명 활용**: 검색어에서 저자명 추출하여 별도 검증

### 테스트 케이스
- "밝은밤 최은영" → "밝은 밤" 찾아야 함
- "클린 코드" → "Clean Code(클린 코드)" 찾아야 함 (현재 정상)
- "해리 포터" → 세트 상품 아닌 개별 권 우선

---

## [2026-02-04] 교보문고 Playwright 연결 오류

### 현상
```
[kyobo] 에러 발생: Connection closed while reading from the driver
```

### 원인 분석
- Playwright 브라우저 초기화 과정에서 연결이 끊어짐
- 병렬 실행 시 리소스 경합 또는 타이밍 이슈 가능성

### 해결 방안
1. **[P1] HTTP 기반 전환 테스트**: 교보문고도 서버 사이드 렌더링인지 확인
2. **[P2] Playwright 재시도 로직**: 연결 실패 시 재시도
3. **[P3] 순차 실행 옵션**: 병렬 실행 대신 순차 실행 옵션 제공

---

## [2026-02-04] 알라딘 API 전환 완료

### 변경 내용
- Playwright 기반 크롤러 → API 기반 크롤러
- `ItemSearch` API로 검색, `ItemLookUp` API로 평점/리뷰 조회

### 개선 효과
| 항목 | 크롤링 | API |
|------|--------|-----|
| 속도 | 5-7초 | 0.5-1초 |
| 메모리 | ~200MB | ~20MB |
| 리뷰 수 정확도 | 6건 (파싱 오류) | 234건 (정확) |
| 안정성 | HTML 변경에 취약 | 안정적 |